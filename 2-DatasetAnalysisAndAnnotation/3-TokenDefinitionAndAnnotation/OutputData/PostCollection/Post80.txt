xpdf is probably a good reference implementation for this sort of problem.  I have successfully used them to open encrypted pdfs before.
