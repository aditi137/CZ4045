A plugin for GSview for viewing encrypted PDFs is here.
If this works for you, you may be able to look at the source.
