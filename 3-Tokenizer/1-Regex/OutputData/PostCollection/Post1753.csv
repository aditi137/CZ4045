,0
0,if
1,algebraic
2,manipulation
3,fails
4,","
5,you
6,can
7,go
8,for
9,a
10,numerical
11,solution
12,of
13,your
14,constraint
15,","
16,running
17,for
18,example
19,fsolve
20,at
21,each
22,timestep
23,:
24,Clearly
25,this
26,will
27,slow
28,down
29,your
30,time
31,integration
32,.
33,Always
34,check
35,that
36,fsolve
37,finds
38,a
39,good
40,solution
41,","
42,and
43,flush
44,the
45,output
46,so
47,that
48,you
49,can
50,realize
51,it
52,as
53,it
54,happens
55,and
56,stop
57,the
58,simulation
59,.
60,About
61,how
62,to
63,"""cache"""
64,the
65,value
66,of
67,a
68,variable
69,at
70,a
71,previous
72,timestep
73,","
74,you
75,can
76,exploit
77,the
78,fact
79,that
80,default
81,arguments
82,are
83,calculated
84,only
85,at
86,the
87,function
88,definition
89,","
90,Notice
91,that
92,in
93,order
94,for
95,the
96,trick
97,to
98,work
99,the
100,cache
101,parameter
102,must
103,be
104,mutable
105,","
106,and
107,that
108,'s
109,why
110,I
111,use
112,a
113,list
114,.
115,See
116,this
117,link
118,if
119,you
120,are
121,not
122,familiar
123,with
124,how
125,default
126,arguments
127,work
128,.
129,Notice
130,that
131,the
132,two
133,codes
134,DO
135,NOT
136,produce
137,the
138,same
139,result
140,","
141,and
142,you
143,should
144,be
145,very
146,careful
147,using
148,the
149,value
150,at
151,the
152,previous
153,timestep
154,","
155,both
156,for
157,numerical
158,stability
159,and
160,precision
161,.
162,The
163,second
164,is
165,clearly
166,much
167,faster
168,though
169,.
