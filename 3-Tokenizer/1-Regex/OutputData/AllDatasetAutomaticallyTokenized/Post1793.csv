Groupby
is
your
friend
.
This
will
scale
very
well
;
only
a
small
constant
in
the
number
of
features
.
It
will
be
roughly
O(number of groups)
Create
some
test
data
","
group
sizes
are
7-12
","
70k
groups
Create
a
frame
where
you
select
the
first
3
rows
and
the
final
row
from
each
group
(
note
that
this
WILL
handle
groups
of
size
<
4
","
however
your
final
row
may
overlap
another
","
you
may
wish
to
do
a
groupby.filter
to
remedy
this
)
And
pretty
fast
For
further
manipulation
you
usually
should
stop
here
and
use
this
(
as
its
in
a
nice
grouped
format
that's
easy
to
deal
with
)
.
If
you
want
to
translate
this
to
a
wide
format
