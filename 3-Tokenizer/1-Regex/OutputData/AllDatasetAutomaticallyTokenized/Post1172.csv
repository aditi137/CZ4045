What
makes
you
think
your
only
have
one
connection
to
redis
?
Actually
my
little
test
shows
that
your
server
is
indeed
opening
lots
of
connections
to
redis
.
To
make
the
test
more
clear
","
I
modified
your
print
statement
a
bit
:
Then
run
this
script
to
make
some
requests
:
And
here's
what
I
got
:
It
can
be
seen
that
at
peek
time
you
have
10
greenlets
running
simultaneously
","
waiting
for
sockets
.
Your
code
looks
perfectly
fine
to
me
.
Why
'
the
performance
is
bad
'
is
another
story
.
It
could
be
your
sorted
set
of
'
online
'
is
tooo
large
.
Or
more
likely
you
are
using
a
blocking
client
to
test
the
server
","
in
which
case
you'll
see
only
one
connection
to
redis
.
