I
found
this
code
much
simpler
