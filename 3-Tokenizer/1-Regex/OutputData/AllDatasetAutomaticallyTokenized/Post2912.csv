I
have
a
database
schema
in
Postgres
that
looks
like
this
(
in
pseudo
code
)
:
Hopefully
this
makes
intuitive
sense
.
It's
a
users
table
that
has
a
many-to-many
relationship
with
a
permissions
table
as
well
as
a
many-to-many
relationship
with
an
addresses
table
.
In
Python
","
when
I
perform
the
correct
SQLAlchemy
query
incantations
","
I
get
back
results
that
look
something
like
this
(
after
converting
them
to
a
list
of
dictionaries
in
Python
)
:
So
in
this
contrived
example
","
Joe
is
both
a
user
and
and
an
admin
.
John
is
only
a
user
.
Both
Joe's
home
and
work
addresses
exist
in
the
database
.
Only
John's
home
address
exists
.
So
the
question
is
","
does
anybody
know
the
best
way
to
go
from
these
SQL
query
'
results
'
to
the
more
compact
'
desired_results
'
below
?
Additional
information
required
:
Small
list
of
dictionaries
describing
the
'
labels
'
I
would
like
to
use
in
the
desired_results
for
each
of
the
fields
that
have
many-to-many
relationships
.
Final
consideration
","
I've
put
together
a
concrete
example
for
the
purposes
of
this
question
","
but
in
general
I'm
trying
to
solve
the
problem
of
querying
SQL
databases
in
general
","
assuming
an
arbitrary
amount
of
relationships
.
SQLAlchemy
ORM
solves
this
problem
well
","
but
I'm
limited
to
using
SQLAlchemy
Core
;
so
am
trying
to
build
my
own
solution
.
Update
Here's
an
answer
","
but
I'm
not
sure
it's
the
best
/
most
efficient
solution
.
Can
anyone
come
up
with
something
better
?
